/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):(e.goog=e.goog||{},e.goog.swlib=t())})(this,function(){'use strict';function e(ve,_e){for(var Ce,be=[],Ee=0,Ne=0,xe='',qe=_e&&_e.delimiter||'/';null!=(Ce=S.exec(ve));){var ke=Ce[0],Ie=Ce[1],Te=Ce.index;if(xe+=ve.slice(Ne,Te),Ne=Te+ke.length,Ie){xe+=Ie[1];continue}var we=ve[Ne],Se=Ce[2],De=Ce[3],Me=Ce[4],We=Ce[5],Ae=Ce[6],Pe=Ce[7];xe&&(be.push(xe),xe='');var Oe=Ce[2]||qe,je=Me||We;be.push({name:De||Ee++,prefix:Se||'',delimiter:Oe,optional:'?'===Ae||'*'===Ae,repeat:'+'===Ae||'*'===Ae,partial:null!=Se&&null!=we&&we!==Se,asterisk:!!Pe,pattern:je?s(je):Pe?'.*':'[^'+n(Oe)+']+?'})}return Ne<ve.length&&(xe+=ve.substr(Ne)),xe&&be.push(xe),be}function t(ve){return encodeURI(ve).replace(/[\/?#]/g,function(_e){return'%'+_e.charCodeAt(0).toString(16).toUpperCase()})}function r(ve){return encodeURI(ve).replace(/[?#]/g,function(_e){return'%'+_e.charCodeAt(0).toString(16).toUpperCase()})}function a(ve){for(var _e=Array(ve.length),be=0;be<ve.length;be++)'object'==typeof ve[be]&&(_e[be]=new RegExp('^(?:'+ve[be].pattern+')$'));return function(Ee,Ne){for(var Ie,xe='',qe=Ee||{},Ce=(Ne||{}).pretty?t:encodeURIComponent,ke=0;ke<ve.length;ke++){if(Ie=ve[ke],'string'==typeof Ie){xe+=Ie;continue}var we,Te=qe[Ie.name];if(null==Te)if(Ie.optional){Ie.partial&&(xe+=Ie.prefix);continue}else throw new TypeError('Expected "'+Ie.name+'" to be defined');if(T(Te)){if(!Ie.repeat)throw new TypeError('Expected "'+Ie.name+'" to not repeat, but received `'+JSON.stringify(Te)+'`');if(0===Te.length)if(Ie.optional)continue;else throw new TypeError('Expected "'+Ie.name+'" to not be empty');for(var Se=0;Se<Te.length;Se++){if(we=Ce(Te[Se]),!_e[ke].test(we))throw new TypeError('Expected all "'+Ie.name+'" to match "'+Ie.pattern+'", but received `'+JSON.stringify(we)+'`');xe+=(0===Se?Ie.prefix:Ie.delimiter)+we}continue}if(we=Ie.asterisk?r(Te):Ce(Te),!_e[ke].test(we))throw new TypeError('Expected "'+Ie.name+'" to match "'+Ie.pattern+'", but received "'+we+'"');xe+=Ie.prefix+we}return xe}}function n(ve){return ve.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function s(ve){return ve.replace(/([=!:$\/()])/g,'\\$1')}function o(ve,_e){return ve.keys=_e,ve}function d(ve){return ve.sensitive?'':'i'}function l(ve,_e){var be=ve.source.match(/\((?!\?)/g);if(be)for(var Ee=0;Ee<be.length;Ee++)_e.push({name:Ee,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return o(ve,_e)}function h(ve,_e,be){for(var Ee=[],Ne=0;Ne<ve.length;Ne++)Ee.push(f(ve[Ne],_e,be).source);var xe=new RegExp('(?:'+Ee.join('|')+')',d(be));return o(xe,_e)}function u(ve,_e,be){return g(e(ve,be),_e,be)}function g(ve,_e,be){T(_e)||(be=_e||be,_e=[]),be=be||{};for(var Ce,Ee=be.strict,Ne=!1!==be.end,xe='',qe=0;qe<ve.length;qe++)if(Ce=ve[qe],'string'==typeof Ce)xe+=n(Ce);else{var ke=n(Ce.prefix),Ie='(?:'+Ce.pattern+')';_e.push(Ce),Ce.repeat&&(Ie+='(?:'+ke+Ie+')*'),Ie=Ce.optional?Ce.partial?ke+'('+Ie+')?':'(?:'+ke+'('+Ie+'))?':ke+'('+Ie+')',xe+=Ie}var Te=n(be.delimiter||'/'),we=xe.slice(-Te.length)===Te;return Ee||(xe=(we?xe.slice(0,-Te.length):xe)+'(?:'+Te+'(?=$))?'),xe+=Ne?'$':Ee&&we?'':'(?='+Te+'|$)',o(new RegExp('^'+xe,d(be)),_e)}function f(ve,_e,be){return T(_e)||(be=_e||be,_e=[]),be=be||{},ve instanceof RegExp?l(ve,_e):T(ve)?h(ve,_e,be):u(ve,_e,be)}function y({channel:ve,cacheName:_e,url:be,source:Ee}){q.isInstance({channel:ve},BroadcastChannel),q.isType({cacheName:_e},'string'),q.isType({source:Ee},'string'),q.isType({url:be},'string'),ve.postMessage({type:'CACHE_UPDATED',meta:Ee,payload:{cacheName:_e,updatedUrl:be}})}function v({first:ve,second:_e,headersToCheck:be}){return q.isInstance({first:ve},Response),q.isInstance({second:_e},Response),q.isInstance({headersToCheck:be},Array),be.every(Ee=>{return ve.headers.has(Ee)===_e.headers.has(Ee)&&ve.headers.get(Ee)===_e.headers.get(Ee)})}class _{constructor(ve){this._errors=ve}createError(ve,_e){if(!(ve in this._errors))throw new Error(`Unable to generate error '${ve}'.`);let be=this._errors[ve].replace(/\s+/g,' '),Ee=null;_e&&(be+=` [${_e.message}]`,Ee=_e.stack);const Ne=new Error;return Ne.name=ve,Ne.message=be,Ne.stack=Ee,Ne}}const b={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`};var E=new _(b);const N={'express-route-requires-absolute-path':`When using ExpressRoute, you must
    provide a path that starts with a '/' character. You can only match
    same-origin requests. For more flexibility, use RegExpRoute.`};var x=new _(N),q={atLeastOne:function(_e){const be=Object.keys(_e);if(!be.some(Ee=>_e[Ee]!==void 0))throw Error('Please set at least one of the following parameters: '+be.map(Ee=>`'${Ee}'`).join(', '))},hasMethod:function(_e,be){const Ee=Object.keys(_e).pop(),Ne=typeof _e[Ee][be];if('function'!=Ne)throw Error(`The '${Ee}' parameter must be an object that exposes `+`a '${be}' method.`)},isInstance:function(_e,be){const Ee=Object.keys(_e).pop();if(!(_e[Ee]instanceof be))throw Error(`The '${Ee}' parameter must be an instance of `+`'${be.name}'`)},isOneOf:function(_e,be){const Ee=Object.keys(_e).pop();if(!be.includes(_e[Ee]))throw Error(`The '${Ee}' parameter must be set to one of the `+`following: ${be}`)},isType:function(_e,be){const Ee=Object.keys(_e).pop(),Ne=typeof _e[Ee];if(Ne!==be)throw Error(`The '${Ee}' parameter has the wrong type. `+`(Expected: ${be}, actual: ${Ne})`)},isSWEnv:function(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function(_e,be){const Ee=Object.keys(_e).pop(),Ne=_e[Ee];if(Ne!==be)throw Error(`The '${Ee}' parameter has the wrong value. `+`(Expected: ${be}, actual: ${Ne})`)}};const C=['DELETE','GET','HEAD','POST','PUT'];class k{constructor({match:ve,handler:_e,method:be}={}){q.isType({match:ve},'function'),q.hasMethod({handler:_e},'handle'),this.match=ve,this.handler=_e,be?(q.isOneOf({method:be},C),this.method=be):this.method='GET'}}var I=Array.isArray||function(ve){return'[object Array]'==Object.prototype.toString.call(ve)},T=I,w=f,S=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');w.parse=e,w.compile=function(_e,be){return a(e(_e,be))},w.tokensToFunction=a,w.tokensToRegExp=g;class D extends k{constructor({path:ve,handler:_e,method:be}){if('/'!==ve.substring(0,1))throw x.createError('express-route-requires-absolute-path');let Ee=[];const Ne=w(ve,Ee);super({match:({url:xe})=>{if(xe.origin!==location.origin)return null;const qe=xe.pathname.match(Ne);if(!qe)return null;const Ce={};return Ee.forEach((ke,Ie)=>{Ce[ke.name]=qe[Ie+1]}),Ce},handler:_e,method:be})}}class M extends k{constructor({regExp:ve,handler:_e,method:be}){q.isInstance({regExp:ve},RegExp),super({match:({url:Ee})=>{const Ne=Ee.href.match(ve);return Ne?Ne.slice(1):null},handler:_e,method:be})}}class W{setDefaultHandler({handler:ve}={}){q.hasMethod({handler:ve},'handle'),this.defaultHandler=ve}setCatchHandler({handler:ve}={}){q.hasMethod({handler:ve},'handle'),this.catchHandler=ve}registerRoutes({routes:ve}={}){q.isInstance({routes:ve},Array),self.addEventListener('fetch',_e=>{const be=new URL(_e.request.url);if(be.protocol.startsWith('http')){let Ee;for(let Ne of ve||[])if(Ne.method===_e.request.method){const xe=Ne.match({url:be,event:_e});if(xe){let qe=xe;Array.isArray(qe)&&0===qe.length?qe=void 0:qe.constructor===Object&&0===Object.keys(qe).length&&(qe=void 0),Ee=Ne.handler.handle({url:be,event:_e,params:qe});break}}!Ee&&this.defaultHandler&&(Ee=this.defaultHandler.handle({url:be,event:_e})),Ee&&this.catchHandler&&(Ee=Ee.catch(Ne=>{return this.catchHandler.handle({url:be,event:_e,error:Ne})})),Ee&&_e.respondWith(Ee)}})}registerRoute({route:ve}={}){q.isInstance({route:ve},k),this.registerRoutes({routes:[ve]})}}class A{constructor(){this._router=new W}registerRoute(ve,_e){if('function'==typeof _e&&(_e={handle:_e}),'string'==typeof ve){if(0===ve.length)throw E.createError('empty-express-string');this._router.registerRoute({route:new D({path:ve,handler:_e})})}else if(ve instanceof RegExp)this._router.registerRoute({route:new M({regExp:ve,handler:_e})});else if(ve instanceof k)this._router.registerRoute({route:ve});else throw E.createError('unsupported-route-type')}}const P={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var O=new _(P);let R=`sw-runtime-caching`;self&&self.registration&&(R+=`-${self.registration.scope}`);const U=R,B=['cacheDidUpdate','cacheWillMatch','cacheWillUpdate','fetchDidFail'];var K=new _({'multiple-cache-will-update-behaviors':'You cannot register more than one behavior that implements cacheWillUpdate.','multiple-cache-will-match-behaviors':'You cannot register more than one behavior that implements cacheWillMatch.','invalid-reponse-for-caching':'The fetched response could not be cached due to an invalid response code, by default only 20X responses can be cached.'}),F=function(ve){return function(){var _e=ve.apply(this,arguments);return new Promise(function(be,Ee){function Ne(xe,qe){try{var Ce=_e[xe](qe),ke=Ce.value}catch(Ie){return void Ee(Ie)}return Ce.done?void be(ke):Promise.resolve(ke).then(function(Ie){Ne('next',Ie)},function(Ie){Ne('throw',Ie)})}return Ne('next')})}};class H{constructor({cacheName:ve,behaviors:_e,fetchOptions:be,matchOptions:Ee}={}){if(ve?(q.isType({cacheName:ve},'string'),this.cacheName=ve):this.cacheName=U,be&&(q.isType({fetchOptions:be},'object'),this.fetchOptions=be),Ee&&(q.isType({matchOptions:Ee},'object'),this.matchOptions=Ee),this.behaviorCallbacks={},_e&&(q.isInstance({behaviors:_e},Array),_e.forEach(Ne=>{for(let xe of B)'function'==typeof Ne[xe]&&(this.behaviorCallbacks[xe]||(this.behaviorCallbacks[xe]=[]),this.behaviorCallbacks[xe].push(Ne[xe].bind(Ne)))})),this.behaviorCallbacks.cacheWillUpdate&&1!==this.behaviorCallbacks.cacheWillUpdate.length)throw K.createError('multiple-cache-will-update-behaviors');if(this.behaviorCallbacks.cacheWillMatch&&1!==this.behaviorCallbacks.cacheWillMatch.length)throw K.createError('multiple-cache-will-match-behaviors')}getCache(){var ve=this;return F(function*(){return ve._cache||(ve._cache=yield caches.open(ve.cacheName)),ve._cache})()}match({request:ve}){var _e=this;return F(function*(){q.atLeastOne({request:ve});const be=yield _e.getCache();let Ee=yield be.match(ve,_e.matchOptions);return _e.behaviorCallbacks.cacheWillMatch&&(Ee=_e.behaviorCallbacks.cacheWillMatch[0]({cachedResponse:Ee})),Ee})()}fetch({request:ve}){var _e=this;return F(function*(){q.atLeastOne({request:ve});try{return yield fetch(ve,_e.fetchOptions)}catch(be){if(_e.behaviorCallbacks.fetchDidFail)for(let Ee of _e.behaviorCallbacks.fetchDidFail)Ee({request:ve});throw be}})()}fetchAndCache({request:ve,waitOnCache:_e,cacheKey:be}){var Ee=this;return F(function*(){q.atLeastOne({request:ve});let Ne;const xe=yield Ee.fetch({request:ve});let qe=xe.ok;if(Ee.behaviorCallbacks.cacheWillUpdate&&(qe=Ee.behaviorCallbacks.cacheWillUpdate[0]({request:ve,response:xe})),qe){const Ce=xe.clone();Ne=Ee.getCache().then((()=>{var ke=F(function*(Ie){let Te;'opaque'!==xe.type&&Ee.behaviorCallbacks.cacheDidUpdate&&(Te=yield Ee.match({request:ve})),yield Ie.put(be||ve,Ce);for(let we of Ee.behaviorCallbacks.cacheDidUpdate||[])we({cacheName:Ee.cacheName,oldResponse:Te,newResponse:Ce})});return function(Ie){return ke.apply(this,arguments)}})())}else if(!qe&&_e)throw K.createError('invalid-reponse-for-caching');return _e&&Ne&&(yield Ne),xe})()}}class L{constructor({requestWrapper:ve}={}){this.requestWrapper=ve?ve:new H}handle({event:ve,params:_e}={}){throw Error('This abstract method must be implemented in a subclass.')}}class $ extends L{handle({event:ve}={}){var _e=this;return F(function*(){q.isInstance({event:ve},FetchEvent);const be=yield _e.requestWrapper.match({request:ve.request});return be||(yield _e.requestWrapper.fetchAndCache({request:ve.request}))})()}}class G extends L{handle({event:ve}={}){var _e=this;return F(function*(){return q.isInstance({event:ve},FetchEvent),yield _e.requestWrapper.match({request:ve.request})})()}}class V extends L{handle({event:ve}={}){var _e=this;return F(function*(){q.isInstance({event:ve},FetchEvent);let be;try{if(be=yield _e.requestWrapper.fetchAndCache({request:ve.request}),be)return be}catch(Ee){}return yield _e.requestWrapper.match({request:ve.request})})()}}class Y extends L{handle({event:ve}={}){var _e=this;return F(function*(){return q.isInstance({event:ve},FetchEvent),yield _e.requestWrapper.fetch({request:ve.request})})()}}class z extends L{handle({event:ve}={}){var _e=this;return F(function*(){q.isInstance({event:ve},FetchEvent);const be=_e.requestWrapper.fetchAndCache({request:ve.request}).catch(function(){return Response.error()}),Ee=yield _e.requestWrapper.match({request:ve.request});return Ee||(yield be)})()}}class X{constructor(ve){this._entriesToCache=new Map,this._requestWrapper=new H({cacheName:ve,fetchOptions:{credentials:'same-origin'}}),this._cacheName=this._requestWrapper.cacheName}cache(ve){ve.forEach(_e=>{this._addEntryToInstallList(this._parseEntry(_e))})}getCacheName(){return this._cacheName}getCachedUrls(){return Array.from(this._entriesToCache.keys()).map(ve=>new URL(ve,location).href)}_addEntryToInstallList(ve){const _e=ve.entryID,be=this._entriesToCache.get(ve.entryID);return be?void this._onDuplicateInstallEntryFound(ve,be):void this._entriesToCache.set(_e,ve)}_performInstallStep(){var ve=this;return F(function*(){if(0!==ve._entriesToCache.size){const _e=[];return ve._entriesToCache.forEach(function(be){_e.push(ve._cacheEntry(be))}),Promise.all(_e)}})()}_cacheEntry(ve){var _e=this;return F(function*(){const be=yield _e._isAlreadyCached(ve);if(!be)try{return yield _e._requestWrapper.fetchAndCache({request:ve.getNetworkRequest(),waitOnCache:!0,cacheKey:ve.request}),_e._onEntryCached(ve)}catch(Ee){throw O.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${ve.request.url}': ${Ee.message}`})}})()}_cleanUpOldEntries(){var ve=this;return F(function*(){if(yield caches.has(ve._cacheName)){const _e=[];ve._entriesToCache.forEach(function(xe){_e.push(xe.request.url)});const be=yield ve._getCache(),Ee=yield be.keys(),Ne=Ee.filter(function(xe){return!_e.includes(xe.url)});return Promise.all(Ne.map(function(xe){return be.delete(xe)}))}})()}_getCache(){var ve=this;return F(function*(){return ve._cache||(ve._cache=yield caches.open(ve._cacheName)),ve._cache})()}_parseEntry(ve){throw O.createError('should-override')}_onDuplicateEntryFound(ve,_e){throw O.createError('should-override')}_isAlreadyCached(ve){throw O.createError('should-override')}_onEntryCached(ve){throw O.createError('should-override')}}var J=function(_e,be){return be={exports:{}},_e(be,be.exports),be.exports}(function(ve){'use strict';(function(){function _e(Ae){return Array.prototype.slice.call(Ae)}function be(Ae){return new Promise(function(Pe,Oe){Ae.onsuccess=function(){Pe(Ae.result)},Ae.onerror=function(){Oe(Ae.error)}})}function Ee(Ae,Pe,Oe){var je,Re=new Promise(function(Ue,Be){je=Ae[Pe].apply(Ae,Oe),be(je).then(Ue,Be)});return Re.request=je,Re}function Ne(Ae,Pe,Oe){var je=Ee(Ae,Pe,Oe);return je.then(function(Re){if(Re)return new Te(Re,je.request)})}function xe(Ae,Pe,Oe){Oe.forEach(function(je){Object.defineProperty(Ae.prototype,je,{get:function(){return this[Pe][je]},set:function(Re){this[Pe][je]=Re}})})}function qe(Ae,Pe,Oe,je){je.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return Ee(this[Pe],Re,arguments)})})}function Ce(Ae,Pe,Oe,je){je.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return this[Pe][Re].apply(this[Pe],arguments)})})}function ke(Ae,Pe,Oe,je){je.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return Ne(this[Pe],Re,arguments)})})}function Ie(Ae){this._index=Ae}function Te(Ae,Pe){this._cursor=Ae,this._request=Pe}function we(Ae){this._store=Ae}function Se(Ae){this._tx=Ae,this.complete=new Promise(function(Pe,Oe){Ae.oncomplete=function(){Pe()},Ae.onerror=function(){Oe(Ae.error)},Ae.onabort=function(){Oe(Ae.error)}})}function De(Ae,Pe,Oe){this._db=Ae,this.oldVersion=Pe,this.transaction=new Se(Oe)}function Me(Ae){this._db=Ae}xe(Ie,'_index',['name','keyPath','multiEntry','unique']),qe(Ie,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),ke(Ie,'_index',IDBIndex,['openCursor','openKeyCursor']),xe(Te,'_cursor',['direction','key','primaryKey','value']),qe(Te,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(Ae){Ae in IDBCursor.prototype&&(Te.prototype[Ae]=function(){var Pe=this,Oe=arguments;return Promise.resolve().then(function(){return Pe._cursor[Ae].apply(Pe._cursor,Oe),be(Pe._request).then(function(je){if(je)return new Te(je,Pe._request)})})})}),we.prototype.createIndex=function(){return new Ie(this._store.createIndex.apply(this._store,arguments))},we.prototype.index=function(){return new Ie(this._store.index.apply(this._store,arguments))},xe(we,'_store',['name','keyPath','indexNames','autoIncrement']),qe(we,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),ke(we,'_store',IDBObjectStore,['openCursor','openKeyCursor']),Ce(we,'_store',IDBObjectStore,['deleteIndex']),Se.prototype.objectStore=function(){return new we(this._tx.objectStore.apply(this._tx,arguments))},xe(Se,'_tx',['objectStoreNames','mode']),Ce(Se,'_tx',IDBTransaction,['abort']),De.prototype.createObjectStore=function(){return new we(this._db.createObjectStore.apply(this._db,arguments))},xe(De,'_db',['name','version','objectStoreNames']),Ce(De,'_db',IDBDatabase,['deleteObjectStore','close']),Me.prototype.transaction=function(){return new Se(this._db.transaction.apply(this._db,arguments))},xe(Me,'_db',['name','version','objectStoreNames']),Ce(Me,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(Ae){[we,Ie].forEach(function(Pe){Pe.prototype[Ae.replace('open','iterate')]=function(){var Oe=_e(arguments),je=Oe[Oe.length-1],Re=this._store||this._index,Ue=Re[Ae].apply(Re,Oe.slice(0,-1));Ue.onsuccess=function(){je(Ue.result)}}})}),[Ie,we].forEach(function(Ae){Ae.prototype.getAll||(Ae.prototype.getAll=function(Pe,Oe){var je=this,Re=[];return new Promise(function(Ue){je.iterateCursor(Pe,function(Be){return Be?(Re.push(Be.value),void 0!==Oe&&Re.length==Oe?void Ue(Re):void Be.continue()):void Ue(Re)})})})});var We={open:function(Ae,Pe,Oe){var je=Ee(indexedDB,'open',[Ae,Pe]),Re=je.request;return Re.onupgradeneeded=function(Ue){Oe&&Oe(new De(Re.result,Ue.oldVersion,Re.transaction))},je.then(function(Ue){return new Me(Ue)})},delete:function(Ae){return Ee(indexedDB,'deleteDatabase',[Ae])}};ve.exports=We})()});class Q{constructor(ve,_e,be){if(ve==void 0||_e==void 0||be==void 0)throw Error('name, version, storeName must be passed to the constructor.');this._name=ve,this._version=_e,this._storeName=be}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=J.open(this._name,this._version,ve=>{ve.createObjectStore(this._storeName)}).then(ve=>{return ve}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then(ve=>{ve.close(),this._dbPromise=null}):void 0}put(ve,_e){return this._getDb().then(be=>{const Ee=be.transaction(this._storeName,'readwrite'),Ne=Ee.objectStore(this._storeName);return Ne.put(_e,ve),Ee.complete})}delete(ve){return this._getDb().then(_e=>{const be=_e.transaction(this._storeName,'readwrite'),Ee=be.objectStore(this._storeName);return Ee.delete(ve),be.complete})}get(ve){return this._getDb().then(_e=>{return _e.transaction(this._storeName).objectStore(this._storeName).get(ve)})}getAllValues(){return this._getDb().then(ve=>{return ve.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then(ve=>{return ve.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}let Z=`sw-precaching-revisioned-${'v1'}`;self&&self.registration&&(Z+=`-${self.registration.scope}`);const ee=Z;class te{constructor(){this._idbHelper=new Q('sw-precaching','1','asset-revisions')}get(ve){return this._idbHelper.get(ve)}put(ve,_e){return this._idbHelper.put(ve,_e)}_close(){this._idbHelper.close()}}class ae{constructor({entryID:ve,revision:_e,request:be,cacheBust:Ee}){this.entryID=ve,this.revision=_e,this.request=be,this.cacheBust=Ee}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let ve=this.request.url;const _e={};if(!0===this.cacheBust)if('cache'in Request.prototype)_e.cache='reload';else{const be=new URL(ve,location);be.search+=(be.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),ve=be.toString()}return new Request(ve,_e)}}class ne extends ae{constructor(ve){if(q.isType({url:ve},'string'),0===ve.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(ve)));super({entryID:ve,revision:ve,request:new Request(ve),cacheBust:!1})}}class se extends ae{constructor({entryID:ve,revision:_e,url:be,cacheBust:Ee}){if('undefined'==typeof Ee&&(Ee=!0),'undefined'==typeof ve&&(ve=new URL(be,location).toString()),q.isType({revision:_e},'string'),0===_e.length)throw O.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(_e)));if(q.isType({url:be},'string'),0===be.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(be)));if(q.isType({entryID:ve},'string'),0===ve.length)throw O.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(ve)));q.isType({cacheBust:Ee},'boolean'),super({entryID:ve,revision:_e,request:new Request(be),cacheBust:Ee})}}class ie extends X{constructor(){super(ee),this._revisionDetailsModel=new te}cache(ve){super.cache(ve)}_parseEntry(ve){if('undefined'==typeof ve||null===ve)throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ve)));let _e;switch(typeof ve){case'string':_e=new ne(ve);break;case'object':_e=new se(ve);break;default:throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)));}return _e}_onDuplicateInstallEntryFound(ve,_e){if(_e.revision!==ve.revision)throw O.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(_e)} <=> `+`${JSON.stringify(ve)}`))}_isAlreadyCached(ve){var _e=this;return F(function*(){const be=yield _e._revisionDetailsModel.get(ve.entryID);if(be!==ve.revision)return!1;const Ee=yield _e._getCache(),Ne=yield Ee.match(ve.request);return!!Ne})()}_onEntryCached(ve){var _e=this;return F(function*(){yield _e._revisionDetailsModel.put(ve.entryID,ve.revision)})()}_close(){this._revisionDetailsModel._close()}}class oe extends ae{constructor(ve){if(!(ve instanceof Request))throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ve)));super({entryID:ve.url,request:ve,cacheBust:!1})}}class ce extends X{constructor(){super()}cache(ve){super.cache(ve)}_parseEntry(ve){if('undefined'==typeof ve||null===ve)throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ve)));if('string'==typeof ve)return new ne(ve);if(ve instanceof Request)return new oe(ve);throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ve)))}_onDuplicateInstallEntryFound(ve,_e){}_isAlreadyCached(ve){return F(function*(){return!1})()}_onEntryCached(ve){}}class de{constructor(){this._eventsRegistered=!1,this._revisionedManager=new ie,this._unrevisionedManager=new ce,this._registerEvents()}_registerEvents(){this._eventsRegistered||(this._eventsRegistered=!0,self.addEventListener('install',ve=>{const _e=Promise.all([this._revisionedManager._performInstallStep(),this._unrevisionedManager._performInstallStep()]).then(()=>{this._close()}).catch(be=>{throw this._close(),be});ve.waitUntil(_e)}),self.addEventListener('activate',ve=>{const _e=Promise.all([this._revisionedManager._cleanUpOldEntries(),this._unrevisionedManager._cleanUpOldEntries()]).then(()=>{this._close()}).catch(be=>{throw this._close(),be});ve.waitUntil(_e)}))}cacheRevisioned({revisionedFiles:ve}={}){q.isInstance({revisionedFiles:ve},Array),this._revisionedManager.cache(ve)}cacheUnrevisioned({unrevisionedFiles:ve}={}){q.isInstance({unrevisionedFiles:ve},Array),this._unrevisionedManager.cache(ve)}getRevisionedCacheManager(){return this._revisionedManager}getUnrevisionedCacheManager(){return this._unrevisionedManager}_close(){this._revisionedManager._close()}}if(!q.isSWEnv())throw O.createError('not-in-sw');const le=`sw-cache-expiration-${self.registration.scope}`,he='url',pe='timestamp';class ue{constructor({maxEntries:ve,maxAgeSeconds:_e}={}){q.atLeastOne({maxEntries:ve,maxAgeSeconds:_e}),ve!==void 0&&q.isType({maxEntries:ve},'number'),_e!==void 0&&q.isType({maxAgeSeconds:_e},'number'),this.maxEntries=ve,this.maxAgeSeconds=_e,this._dbs=new Map,this._caches=new Map}getDB({cacheName:ve}){var _e=this;return F(function*(){if(!_e._dbs.has(ve)){const be=yield J.open(le,1,function(Ee){const Ne=Ee.createObjectStore(ve,{keyPath:he});Ne.createIndex(pe,pe,{unique:!1})});_e._dbs.set(ve,be)}return _e._dbs.get(ve)})()}getCache({cacheName:ve}){var _e=this;return F(function*(){if(!_e._caches.has(ve)){const be=yield caches.open(ve);_e._caches.set(ve,be)}return _e._caches.get(ve)})()}cacheWillMatch({cachedResponse:ve}={}){return this.isResponseFresh({cachedResponse:ve})?ve:null}isResponseFresh({cachedResponse:ve}={}){if(ve&&this.maxAgeSeconds){q.isInstance({cachedResponse:ve},Response);const _e=ve.headers.get('date');if(_e){const be=Date.now(),Ee=new Date(_e);if(Ee.getTime()+1000*this.maxAgeSeconds<be)return!1}}return!0}cacheDidUpdate({cacheName:ve,newResponse:_e}={}){q.isType({cacheName:ve},'string'),q.isInstance({newResponse:_e},Response);const be=Date.now();this.updateTimestamp({cacheName:ve,now:be,url:_e.url}).then(()=>{this.expireEntries({cacheName:ve,now:be})})}updateTimestamp({cacheName:ve,url:_e,now:be}){var Ee=this;return F(function*(){q.isType({url:_e},'string'),'undefined'==typeof be&&(be=Date.now());const Ne=yield Ee.getDB({cacheName:ve}),xe=Ne.transaction(ve,'readwrite');xe.objectStore(ve).put({[pe]:be,[he]:_e}),yield xe.complete})()}expireEntries({cacheName:ve,now:_e}={}){var be=this;return F(function*(){'undefined'==typeof _e&&(_e=Date.now());const Ee=be.maxAgeSeconds?yield be.findOldEntries({cacheName:ve,now:_e}):[],Ne=be.maxEntries?yield be.findExtraEntries({cacheName:ve}):[],xe=[...new Set(Ee.concat(Ne))];return yield be.deleteFromCacheAndIDB({cacheName:ve,urls:xe}),xe})()}findOldEntries({cacheName:ve,now:_e}={}){var be=this;return F(function*(){q.isType({now:_e},'number');const Ee=_e-1000*be.maxAgeSeconds,Ne=[],xe=yield be.getDB({cacheName:ve}),qe=xe.transaction(ve,'readonly'),Ce=qe.objectStore(ve),ke=Ce.index(pe);return ke.iterateCursor(function(Ie){Ie&&(Ie.value[pe]<Ee&&Ne.push(Ie.value[he]),Ie.continue())}),yield qe.complete,Ne})()}findExtraEntries({cacheName:ve}){var _e=this;return F(function*(){const be=[],Ee=yield _e.getDB({cacheName:ve}),Ne=Ee.transaction(ve,'readonly'),xe=Ne.objectStore(ve),qe=xe.index(pe),Ce=yield qe.count();return Ce>_e.maxEntries&&qe.iterateCursor(function(ke){ke&&(be.push(ke.value[he]),Ce-be.length>_e.maxEntries&&ke.continue())}),yield Ne.complete,be})()}deleteFromCacheAndIDB({cacheName:ve,urls:_e}={}){var be=this;return F(function*(){if(q.isInstance({urls:_e},Array),0<_e.length){const Ee=yield be.getCache({cacheName:ve}),Ne=yield be.getDB({cacheName:ve});yield _e.forEach((()=>{var xe=F(function*(qe){yield Ee.delete(qe);const Ce=Ne.transaction(ve,'readwrite'),ke=Ce.objectStore(ve);yield ke.delete(qe),yield Ce.complete});return function(qe){return xe.apply(this,arguments)}})())}})()}}const me=['content-length','etag','last-modified'];class ge{constructor({channelName:ve,headersToCheck:_e,source:be}){q.isType({channelName:ve},'string'),this.channelName=ve,this.headersToCheck=_e||me,this.source=be||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}cacheDidUpdate({cacheName:ve,oldResponse:_e,newResponse:be}){q.isType({cacheName:ve},'string'),q.isInstance({newResponse:be},Response),_e&&this.notifyIfUpdated({cacheName:ve,first:_e,second:be})}notifyIfUpdated({first:ve,second:_e,cacheName:be}){q.isType({cacheName:be},'string'),v({first:ve,second:_e,headersToCheck:this.headersToCheck})||y({cacheName:be,url:_e.url,channel:this.channel,source:this.source})}}class fe{constructor(){this._router=new A,this._precacheManager=new de}cacheRevisionedAssets(ve){if(!Array.isArray(ve))throw E.createError('bad-revisioned-cache-list');this._precacheManager.cacheRevisioned({revisionedFiles:ve})}warmRuntimeCache(ve){if(!Array.isArray(ve))throw E.createError('bad-revisioned-cache-list');this._precacheManager.cacheUnrevisioned({unrevisionedFiles:ve})}get router(){return this._router}get Route(){return k}cacheFirst(ve){return this._getCachingMechanism($,ve)}cacheOnly(ve){return this._getCachingMechanism(G,ve)}networkFirst(ve){return this._getCachingMechanism(V,ve)}networkOnly(ve){return this._getCachingMechanism(Y,ve)}staleWhileRevalidate(ve){return this._getCachingMechanism(z,ve)}_getCachingMechanism(ve,_e={}){const be={cacheExpiration:ue,broadcastCacheUpdate:ge},Ee={behaviors:[]};_e.cacheName&&(Ee.cacheName=_e.cacheName);const Ne=Object.keys(be);return Ne.forEach(xe=>{if(_e[xe]){const qe=be[xe],Ce=_e[xe];Ee.behaviors.push(new qe(Ce))}}),_e.behaviors&&_e.behaviors.forEach(xe=>{Ee.behaviors.push(xe)}),new ve({requestWrapper:new H(Ee)})}}if(!q.isSWEnv())throw E.createError('not-in-sw');const ye=new fe;return ye});
//# sourceMappingURL=sw-lib.min.js.map